

# AI 编程指令：耗材管理页面集成分类功能 (Day5 - Task 3.3)

## 1. 任务目标
根据 `day5-plan.md` 中的任务 3.3，完成耗材管理页面的分类功能集成。工作范围涵盖：数据结构分析、后端 API 开发、数据库脚本更新、以及全流程验证。

## 2. 核心原则
1.  **规范驱动**：所有代码必须严格遵循 `development-standards.md`。修改代码前必须回溯关联逻辑，禁止局部修改破坏整体一致性。
2.  **文档同步**：任何数据库表结构的变更必须实时同步至 `init.sql` 及 `database-design.md`。
3.  **教学优先**：输出内容需具备作为“新人培训教材”的清晰度，步骤详尽，逻辑可重现。

## 3. 执行工作流

### 步骤 1：分析与设计
**目的**：明确数据结构与接口规范。
**要求**：
1.  查询现有的实体类和数据库脚本，分析数据结构。
2.  引用 `development-standards.md` 中与本任务相关的至少 3条关键约束。
3.  设计后端 API 接口列表，包含：接口名称、请求方式、参数（名称/类型）、返回数据类型。
4.  列出需要执行的数据库变更 SQL（DDL/DML）。

### 步骤 2：实现与编码
**目的**：将设计转化为高质量代码。
**要求**：
1.  **代码实现**：按设计的 API 列表开发后端接口，并在实际数据库中执行表结构更新。
2.  **规范映射**：在关键代码逻辑（如参数校验、异常处理、SQL操作）处添加注释，标明遵循了哪条规范条款（例：`// 遵循：数据规范-第2条（非空校验）`）。
3.  **关键决策**：简要说明关键技术选型或业务逻辑判断的理由。
4.  **文档更新**：将变更后的 SQL 写入 `init.sql` 及 `database-design.md`。

### 步骤 3：验证与测试
**目的**：确保功能正确且健壮。
**要求**：
1.  **静态检查**：检查前后端字段一致性，确保接口数据契约匹配。
2.  **动态测试**：
    *   使用 **PowerShell** 语法停止并重启前后端服务。
    *   添加详细日志输出。
    *   直接调用 API 接口进行功能测试。
    *   使用 Playwright 进行端到端 (E2E) 确认。
3.  **调试顺序**：若出现错误，严格按照 **数据库 -> 后端 -> 前端 -> 测试文件** 的顺序排查并修复。

### 步骤 4：总结与固化
**目的**：沉淀团队知识。
**要求**：
1.  **规范反馈**：若发现 `development-standards.md` 存在缺失或模糊，提出具体的更新建议。
2.  **快速指南**：编写 3-5 个要点，作为新开发者理解此功能的“快速上手指南”。

---

## 4. 最终交付物格式

请按以下 Markdown 结构输出完整报告：

### 4.1 任务完成状态
*   [ ] 代码开发完成
*   [ ] 数据库同步完成
*   [ ] 测试验证通过

### 4.2 开发过程记录
*   **设计分析**：引用的规范条款、API 设计列表、SQL 变更设计。
*   **代码实现**：完整文件路径及代码内容（包含规范注释）。
*   **验证报告**：测试用例、边界测试说明、错误修复记录（如有）。

### 4.3 代码与文档清单
| 文件/操作 | 路径/内容摘要 | 类型 |
| :--- | :--- | :--- |
| Entity | `com.example.entity.Consumable` | 修改 |
| Controller | `com.example.controller.ConsumableController` | 新增/修改 |
| SQL Script | `init.sql`, `database-design.md` | 更新 |
| ... | ... | ... |

### 4.4 规范遵循摘要
| 规范条款编号 | 核心要求 | 遵循情况 |
| :--- | :--- | :--- |
| 示例：DB-01 | 所有表必须有 created_at | 已遵循 |
| ... | ... | ... |

### 4.5 后续步骤建议
*   `day5-plan.md` 中当前任务的标注更新建议。
*   下一阶段的开发或集成建议。

---
